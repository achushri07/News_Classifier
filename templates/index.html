<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI News Classifier</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a modern typeface -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the digital grid background and particle effects */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000;
            overflow: hidden; /* Prevent scrollbars from the canvas */
        }

        #particle-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        
        /* The main container is positioned on top of the canvas */
        .main-container {
            position: relative;
            z-index: 1;
        }

        /* Styling for the digital grid background on the body */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(to right, rgba(0, 255, 255, 0.1) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(0, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: -1;
            opacity: 0.3;
        }

        /* Custom styling for the textarea scrollbar to match the theme */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track {
            background: #111827; /* bg-gray-900 */
        }
        textarea::-webkit-scrollbar-thumb {
            background-color: #0891b2; /* cyan-600 */
            border-radius: 20px;
            border: 3px solid #111827; /* bg-gray-900 */
        }
    </style>
</head>
<body class="text-gray-200">
    <!-- Canvas for the animated particle background -->
    <canvas id="particle-canvas"></canvas>

    <!-- Main container for the application, centered on the page -->
    <main class="main-container min-h-screen w-full flex items-center justify-center p-4">
        <div class="w-full max-w-4xl grid md:grid-cols-2 gap-12 items-center">
            
            <!-- Left side: Informational text -->
            <div class="text-center md:text-left">
                <h1 class="text-5xl md:text-6xl font-extrabold text-white leading-tight mb-4">
                    Presenting you <span class="text-cyan-400">Advanced</span> News Classifier.
                </h1>
                <p class="text-gray-400 text-lg">
                    Stop guessing. Our AI gives you instant insight into any news article. Just paste the text to classify its category in real-time.
                </p>
            </div>

            <!-- Right side: The classifier application UI -->
            <div class="bg-black/50 backdrop-blur-sm border border-cyan-500/20 rounded-xl p-8 transform transition-all duration-500 shadow-[0_0_25px_rgba(0,255,255,0.1)]">
                <h2 class="text-2xl font-bold text-cyan-400 mb-2 text-center">Predict Category</h2>
                <p class="text-gray-400 mb-6 text-center text-sm">Enter a news snippet below.</p>
                
                <!-- Prediction Form -->
                <form id="prediction-form">
                    <div class="relative">
                        <textarea id="news_text" rows="7" class="w-full bg-gray-900/70 border-2 border-gray-700 rounded-lg p-4 text-gray-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-all duration-300 resize-none" placeholder="Paste news article here..."></textarea>
                    </div>
                    <button type="submit" class="mt-6 w-full bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-white font-semibold py-3 px-10 rounded-lg shadow-lg hover:shadow-cyan-500/30 transform hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-cyan-500">
                        Classify Article
                    </button>
                </form>
            </div>
        </div>
    </main>

    <!-- Modal for displaying the result -->
    <div id="result-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div id="modal-content" class="bg-gray-900/80 border border-cyan-500/30 rounded-xl p-8 text-center shadow-[0_0_35px_rgba(0,255,255,0.2)] max-w-sm w-full transform transition-all duration-300 scale-95 opacity-0">
            <!-- Modal Content (Loader and Result) -->
            <div id="modal-loader" class="hidden flex justify-center items-center flex-col">
                <div class="border-4 border-gray-600 border-t-cyan-500 rounded-full w-8 h-8 animate-spin"></div>
                <p class="mt-4 text-gray-400">Analyzing...</p>
            </div>
            <div id="modal-result-container" class="hidden">
                <h3 class="text-lg font-semibold text-gray-300 mb-4">Predicted Category</h3>
                <div id="modal-result-badge" class="inline-block text-xl font-bold px-8 py-3 rounded-full border-2 transition-all duration-300">
                    <span id="modal-result-text"></span>
                </div>
            </div>
            <button id="close-modal-btn" class="mt-8 w-full bg-gray-700 hover:bg-gray-600 text-white font-semibold py-2 px-6 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-gray-500">
                Done
            </button>
        </div>
    </div>


    <script>
        // --- Particle Canvas Background Animation ---
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        let particlesArray;

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();

        class Particle {
            constructor(x, y, directionX, directionY, size, color) { this.x = x; this.y = y; this.directionX = directionX; this.directionY = directionY; this.size = size; this.color = color; }
            draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); ctx.fillStyle = this.color; ctx.fill(); }
            update() { if (this.x > canvas.width || this.x < 0) { this.directionX = -this.directionX; } if (this.y > canvas.height || this.y < 0) { this.directionY = -this.directionY; } this.x += this.directionX; this.y += this.directionY; this.draw(); }
        }

        function initParticles() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 9000;
            for (let i = 0; i < numberOfParticles; i++) {
                let size = (Math.random() * 1.5) + 0.5;
                let x = (Math.random() * ((innerWidth - size * 2) - (size * 2)) + size * 2);
                let y = (Math.random() * ((innerHeight - size * 2) - (size * 2)) + size * 2);
                let directionX = (Math.random() * .4) - .2;
                let directionY = (Math.random() * .4) - .2;
                let color = 'rgba(0, 255, 255, 0.4)';
                particlesArray.push(new Particle(x, y, directionX, directionY, size, color));
            }
        }

        function animateParticles() {
            requestAnimationFrame(animateParticles);
            ctx.clearRect(0, 0, innerWidth, innerHeight);
            for (let i = 0; i < particlesArray.length; i++) { particlesArray[i].update(); }
            connectParticles();
        }

        function connectParticles() {
            let opacityValue = 1;
            for (let a = 0; a < particlesArray.length; a++) {
                for (let b = a; b < particlesArray.length; b++) {
                    let distance = ((particlesArray[a].x - particlesArray[b].x) * (particlesArray[a].x - particlesArray[b].x)) + ((particlesArray[a].y - particlesArray[b].y) * (particlesArray[a].y - particlesArray[b].y));
                    if (distance < (canvas.width / 7) * (canvas.height / 7)) {
                        opacityValue = 1 - (distance / 20000);
                        ctx.strokeStyle = `rgba(0, 255, 255, ${opacityValue * 0.2})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                        ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                        ctx.stroke();
                    }
                }
            }
        }
        
        window.addEventListener('resize', () => { resizeCanvas(); initParticles(); });
        initParticles();
        animateParticles();


        // --- Form Submission and Modal Logic ---
        const categoryClasses = {
            'SPORT': 'bg-green-500/10 text-green-400 border-green-500/30',
            'BUSINESS': 'bg-blue-500/10 text-blue-400 border-blue-500/30',
            'POLITICS': 'bg-red-500/10 text-red-400 border-red-500/30',
            'TECH': 'bg-cyan-500/10 text-cyan-400 border-cyan-500/30',
            'ENTERTAINMENT': 'bg-purple-500/10 text-purple-400 border-purple-500/30',
            'DEFAULT': 'bg-yellow-500/10 text-yellow-400 border-yellow-500/30'
        };

        const predictionForm = document.getElementById('prediction-form');
        const newsText = document.getElementById('news_text');
        
        const resultModal = document.getElementById('result-modal');
        const modalContent = document.getElementById('modal-content');
        const modalLoader = document.getElementById('modal-loader');
        const modalResultContainer = document.getElementById('modal-result-container');
        const modalResultBadge = document.getElementById('modal-result-badge');
        const modalResultText = document.getElementById('modal-result-text');
        const closeModalBtn = document.getElementById('close-modal-btn');
        
        // Functions to show and hide the modal with transitions
        function showModal() {
            resultModal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
            }, 10);
        }

        function hideModal() {
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                resultModal.classList.add('hidden');
                modalLoader.classList.add('hidden');
                modalResultContainer.classList.add('hidden');
            }, 300);
        }

        // Event listeners for closing the modal
        closeModalBtn.addEventListener('click', hideModal);
        resultModal.addEventListener('click', (event) => {
            if (event.target === resultModal) {
                hideModal();
            }
        });

        // Handle form submission
        predictionForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const text = newsText.value;
            
            showModal();
            modalLoader.classList.remove('hidden');
            modalResultContainer.classList.add('hidden');

            if (!text.trim()) {
                modalResultContainer.classList.remove('hidden');
                const classes = categoryClasses['DEFAULT'];
                modalResultBadge.className = `inline-block text-xl font-bold px-8 py-3 rounded-full border-2 transition-all duration-300 ${classes}`;
                modalResultText.textContent = 'Please enter text';
                modalLoader.classList.add('hidden');
                return;
            }

            fetch('/predict', {
                method: 'POST',
                body: new URLSearchParams({ 'news_text': text }),
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
            })
            .then(response => {
                if (!response.ok) { throw new Error('Network response was not ok'); }
                return response.json();
            })
            .then(data => {
                const category = data.category.toUpperCase();
                const classes = categoryClasses[category] || categoryClasses['DEFAULT'];
                modalResultBadge.className = `inline-block text-xl font-bold px-8 py-3 rounded-full border-2 transition-all duration-300 ${classes}`;
                modalResultText.textContent = category;
            })
            .catch(error => {
                console.error('Error:', error);
                const classes = categoryClasses['DEFAULT'];
                modalResultBadge.className = `inline-block text-xl font-bold px-8 py-3 rounded-full border-2 transition-all duration-300 ${classes}`;
                modalResultText.textContent = 'Error';
            })
            .finally(() => {
                modalLoader.classList.add('hidden');
                modalResultContainer.classList.remove('hidden');
            });
        });
    </script>
</body>
</html>